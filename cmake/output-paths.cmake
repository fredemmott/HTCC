set(OUTPUT_ROOT "${CMAKE_CURRENT_BINARY_DIR}/out/$<CONFIG>" CACHE PATH "Where to put final artifacts")

set(CMAKE_RUNTIME_OUTPUT_DIRECTORY "${OUTPUT_ROOT}/bin")
set(CMAKE_PDB_OUTPUT_DIRECTORY "${CMAKE_RUNTIME_OUTPUT_DIRECTORY}")
set(CMAKE_LIBRARY_OUTPUT_DIRECTORY "${CMAKE_RUNTIME_OUTPUT_DIRECTORY}")

get_property(IS_MULTI_CONFIG GLOBAL PROPERTY GENERATOR_IS_MULTI_CONFIG)
if (IS_MULTI_CONFIG)
  foreach (CONFIG IN LISTS CMAKE_CONFIGURATION_TYPES)
    string(TOUPPER "${CONFIG}" CONFIG)
    foreach (KIND IN ITEMS RUNTIME PDB LIBRARY)
      set(VAR "CMAKE_${KIND}_OUTPUT_DIRECTORY")
      set("${VAR}_${CONFIG}" "${${VAR}}")
    endforeach ()
  endforeach ()
endif ()